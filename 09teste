#!/bin/bash
# ============================================
# SISTEMA COMPLETO DE MINERA√á√ÉO NICEHASH
# Modo Autom√°tico - Instala e Inicia Imediatamente
# ============================================

# ============= CONFIGURA√á√ïES PRINCIPAIS =============
WALLET="3P8LjBgV7xH3qDq9eQaRqMXr1kQHbd6u3E"
WORKER="miner_$(date +%s)"
DISCORD_WEBHOOK="https://discord.com/api/webhooks/1470009252063088661/1j4kNu2sDcGQmFCywnbd_p1BEbb1DTcN_VXt5OYpX8_FsQI2YKB3tCjS2Okp_msUX9Mh"
POOL_URL="randomxmonero.auto.nicehash.com:9200"

# Configura√ß√µes de pre√ßo (atualizadas via API)
BTC_PRICE=0
USD_TO_BRL=0

# Configura√ß√µes de minera√ß√£o
MINER_THREADS=2
CPU_PRIORITY=1
DONATE_LEVEL=1
MAX_CPU_USAGE=80

# ============= DETEC√á√ÉO DE SISTEMA =============
detect_system() {
    echo "[*] Detectando sistema operacional..."
    
    if [[ -d "/data/data/com.termux" ]]; then
        SYSTEM="termux"
        echo "[+] Sistema: Termux (Android)"
    elif [[ "$OSTYPE" == "linux-gnu"* ]]; then
        SYSTEM="linux"
        echo "[+] Sistema: Linux"
    elif [[ "$OSTYPE" == "darwin"* ]]; then
        SYSTEM="macos"
        echo "[+] Sistema: macOS"
    elif [[ "$OSTYPE" == "msys" ]] || [[ "$OSTYPE" == "cygwin" ]]; then
        SYSTEM="windows"
        echo "[+] Sistema: Windows (Git Bash/Cygwin)"
    elif [[ "$COMSPEC" == *"cmd.exe"* ]]; then
        SYSTEM="windows_cmd"
        echo "[+] Sistema: Windows CMD"
    else
        SYSTEM="unknown"
        echo "[!] Sistema n√£o identificado"
    fi
}

# ============= SISTEMA DE LOGS AVAN√áADO =============
LOG_DIR="$HOME/miner_logs"
MAIN_LOG="$LOG_DIR/main.log"
ERROR_LOG="$LOG_DIR/error.log"
STATS_LOG="$LOG_DIR/stats.log"
PERF_LOG="$LOG_DIR/performance.log"

init_logs() {
    mkdir -p "$LOG_DIR"
    touch "$MAIN_LOG" "$ERROR_LOG" "$STATS_LOG" "$PERF_LOG"
    echo "[*] Sistema de logs inicializado em: $LOG_DIR"
}

log_message() {
    local level="$1"
    local message="$2"
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    
    case $level in
        "INFO")
            echo "[+] $timestamp - $message"
            echo "[INFO] $timestamp - $message" >> "$MAIN_LOG"
            ;;
        "WARN")
            echo "[!] $timestamp - $message"
            echo "[WARN] $timestamp - $message" >> "$MAIN_LOG"
            echo "[WARN] $timestamp - $message" >> "$ERROR_LOG"
            ;;
        "ERROR")
            echo "[X] $timestamp - $message"
            echo "[ERROR] $timestamp - $message" >> "$MAIN_LOG"
            echo "[ERROR] $timestamp - $message" >> "$ERROR_LOG"
            ;;
        "STATS")
            echo "[*] $timestamp - $message"
            echo "[STATS] $timestamp - $message" >> "$STATS_LOG"
            ;;
        "PERF")
            echo "[#] $timestamp - $message"
            echo "[PERF] $timestamp - $message" >> "$PERF_LOG"
            ;;
    esac
}

# ============= DISCORD WEBHOOK SYSTEM =============
send_discord() {
    local content="$1"
    local embed="$2"
    
    if [[ -n "$embed" ]]; then
        curl -s -H "Content-Type: application/json" -X POST -d "$embed" "$DISCORD_WEBHOOK" > /dev/null 2>&1 &
    else
        curl -s -H "Content-Type: application/json" -X POST -d "{\"content\":\"$content\"}" "$DISCORD_WEBHOOK" > /dev/null 2>&1 &
    fi
}

send_discord_embed() {
    local title="$1"
    local description="$2"
    local color="$3"
    local fields="$4"
    
    local embed="{
        \"embeds\": [{
            \"title\": \"$title\",
            \"description\": \"$description\",
            \"color\": $color,
            \"timestamp\": \"$(date -Iseconds)\",
            \"footer\": {\"text\": \"Miner System\"},
            \"fields\": [$fields]
        }]
    }"
    
    send_discord "" "$embed"
}

# ============= SISTEMA FINANCEIRO COMPLETO =============
update_prices() {
    echo "[*] Atualizando pre√ßos de criptomoedas..."
    
    # Tentar API 1: CoinGecko
    local btc_data=$(curl -s "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd,brl")
    
    if [[ -n "$btc_data" ]] && [[ "$btc_data" != *"error"* ]]; then
        BTC_PRICE=$(echo "$btc_data" | grep -o '"usd":[0-9.]*' | cut -d: -f2)
        local btc_brl=$(echo "$btc_data" | grep -o '"brl":[0-9.]*' | cut -d: -f2)
        USD_TO_BRL=$(echo "scale=4; $btc_brl / $BTC_PRICE" | bc 2>/dev/null || echo "5.20")
        echo "[+] Pre√ßos atualizados: BTC=\$${BTC_PRICE} | BRL=${USD_TO_BRL}"
    else
        # Valores padr√£o se API falhar
        BTC_PRICE=43000
        USD_TO_BRL=5.20
        echo "[!] API falhou, usando valores padr√£o"
    fi
}

# ============= INSTALA√á√ÉO AUTOM√ÅTICA DO XMRIG =============
install_xmrig_auto() {
    echo "[*] Iniciando instala√ß√£o autom√°tica do XMRig..."
    
    # Parar processos existentes
    pkill -9 xmrig 2>/dev/null
    
    # Limpar instala√ß√µes anteriores
    rm -rf ~/xmrig* 2>/dev/null
    
    # Instalar depend√™ncias baseadas no sistema
    case $SYSTEM in
        "termux")
            echo "[*] Atualizando pacotes Termux..."
            pkg update -y && pkg upgrade -y > /dev/null 2>&1
            echo "[*] Instalando depend√™ncias..."
            pkg install -y wget tar git curl jq bc > /dev/null 2>&1
            ;;
        "linux")
            if command -v apt &>/dev/null; then
                echo "[*] Atualizando pacotes Linux (APT)..."
                sudo apt update && sudo apt upgrade -y > /dev/null 2>&1
                echo "[*] Instalando depend√™ncias..."
                sudo apt install -y wget tar git curl jq bc > /dev/null 2>&1
            elif command -v yum &>/dev/null; then
                echo "[*] Atualizando pacotes Linux (YUM)..."
                sudo yum update -y > /dev/null 2>&1
                echo "[*] Instalando depend√™ncias..."
                sudo yum install -y wget tar git curl jq bc > /dev/null 2>&1
            fi
            ;;
        "windows"|"windows_cmd")
            echo "[!] Windows detectado - baixando XMRig manualmente..."
            return 1
            ;;
    esac
    
    # Baixar XMRig apropriado
    echo "[*] Baixando XMRig..."
    
    if [[ "$SYSTEM" == "termux" ]]; then
        # ARM64 para Android
        wget -q https://github.com/xmrig/xmrig/releases/download/v6.18.1/xmrig-6.18.1-linux-arm64.tar.gz
        tar -xzf xmrig-6.18.1-linux-arm64.tar.gz
        mv xmrig-6.18.1 xmrig
        rm xmrig-6.18.1-linux-arm64.tar.gz
    elif [[ "$SYSTEM" == "linux" ]]; then
        # Linux x64
        wget -q https://github.com/xmrig/xmrig/releases/download/v6.18.1/xmrig-6.18.1-linux-x64.tar.gz
        tar -xzf xmrig-6.18.1-linux-x64.tar.gz
        mv xmrig-6.18.1 xmrig
        rm xmrig-6.18.1-linux-x64.tar.gz
    fi
    
    # Verificar instala√ß√£o
    if [[ -f ~/xmrig/xmrig ]]; then
        chmod +x ~/xmrig/xmrig
        echo "[+] XMRig instalado com sucesso"
        return 0
    else
        echo "[!] Falha ao baixar XMRig, criando simulador..."
        create_simulator
        return 1
    fi
}

create_simulator() {
    mkdir -p ~/xmrig
    
    cat > ~/xmrig/xmrig << 'EOF'
#!/usr/bin/env bash
# Simulador de minera√ß√£o para quando o XMRig real n√£o est√° dispon√≠vel

echo "XMRig Simulation Mode - NiceHash"
echo "================================"
echo "Wallet: 3P8LjBgV7xH3qDq9eQaRqMXr1kQHbd6u3E"
echo "Pool: randomxmonero.auto.nicehash.com:9200"
echo ""

while true; do
    HASHRATE=$((50 + RANDOM % 100))
    TEMP=$((35 + RANDOM % 30))
    ACCEPTED=$((RANDOM % 5))
    REJECTED=$((RANDOM % 2))
    
    echo "[$(date '+%H:%M:%S')] Hashrate: ${HASHRATE} H/s | Temp: ${TEMP}¬∞C"
    echo "  Accepted: $ACCEPTED | Rejected: $REJECTED"
    
    sleep 10
done
EOF
    
    chmod +x ~/xmrig/xmrig
    echo "[+] Simulador criado"
}

# ============= CONFIGURA√á√ÉO DO MINERADOR =============
create_config() {
    cat > ~/config.json << EOF
{
    "autosave": true,
    "cpu": true,
    "opencl": false,
    "cuda": false,
    "pools": [
        {
            "url": "$POOL_URL",
            "user": "$WALLET.$WORKER",
            "pass": "x",
            "keepalive": true,
            "tls": false,
            "nicehash": true
        }
    ],
    "print-time": 30,
    "health-print-time": 60,
    "retries": 5,
    "retry-pause": 5,
    "donate-level": $DONATE_LEVEL,
    "max-cpu-usage": $MAX_CPU_USAGE,
    "cpu-priority": $CPU_PRIORITY,
    "cpu-max-threads-hint": 75,
    "hw-aes": true,
    "asm": true,
    "randomx-init": 1,
    "randomx-mode": "auto",
    "http": {
        "enabled": true,
        "host": "127.0.0.1",
        "port": 8080,
        "restricted": false
    }
}
EOF
    echo "[+] Configura√ß√£o criada: ~/config.json"
}

# ============= SISTEMA DE MINERA√á√ÉO AUTOM√ÅTICO =============
start_auto_mining() {
    clear
    echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
    echo "‚ïë      SISTEMA DE MINERA√á√ÉO NICEHASH - MODO AUTOM√ÅTICO    ‚ïë"
    echo "‚ïë              Instala√ß√£o e In√≠cio Autom√°tico             ‚ïë"
    echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
    echo ""
    
    # Detectar sistema
    detect_system
    
    # Enviar notifica√ß√£o inicial para Discord
    echo "[*] Enviando notifica√ß√£o inicial para Discord..."
    send_discord_embed "üöÄ MINERA√á√ÉO INICIADA - MODO AUTOM√ÅTICO" "Sistema de minera√ß√£o NiceHash iniciado automaticamente\nWorker: $WORKER\nSistema: $SYSTEM" 65280 "[
        {\"name\": \"Worker\", \"value\": \"$WORKER\", \"inline\": true},
        {\"name\": \"Wallet\", \"value\": \"$WALLET\", \"inline\": true},
        {\"name\": \"Sistema\", \"value\": \"$SYSTEM\", \"inline\": true}
    ]"
    
    # Inicializar logs
    echo "[*] Inicializando sistema de logs..."
    init_logs
    
    # Atualizar pre√ßos
    echo "[*] Atualizando pre√ßos de criptomoedas..."
    update_prices
    
    # Instalar XMRig
    echo "[*] Iniciando instala√ß√£o do XMRig..."
    install_xmrig_auto
    
    # Criar configura√ß√£o
    echo "[*] Criando arquivo de configura√ß√£o..."
    create_config
    
    # Iniciar minera√ß√£o
    echo ""
    echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
    echo "‚ïë        INICIANDO MINERA√á√ÉO AGORA...         ‚ïë"
    echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
    echo ""
    
    if [[ -f ~/xmrig/xmrig ]]; then
        echo "[*] Iniciando XMRig..."
        cd ~
        nohup ./xmrig/xmrig -c config.json > ~/miner_logs/xmrig_output.log 2>&1 &
        MINER_PID=$!
        echo "[+] Miner PID: $MINER_PID"
        echo "[+] Sa√≠da sendo salva em: ~/miner_logs/xmrig_output.log"
    else
        echo "[!] XMRig n√£o encontrado, usando simulador..."
        nohup ~/xmrig/xmrig > ~/miner_logs/simulator_output.log 2>&1 &
        MINER_PID=$!
    fi
    
    # Mostrar informa√ß√µes
    echo ""
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INFORMA√á√ïES DO SISTEMA ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo "  üíº Carteira: $WALLET"
    echo "  üë∑ Worker: $WORKER"
    echo "  ‚õèÔ∏è  Pool: $POOL_URL"
    echo "  üîó Discord: Webhook configurado"
    echo "  üìä Logs: $LOG_DIR"
    echo "  üÜî PID: $MINER_PID"
    echo ""
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê COMANDOS √öTEIS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo "  Para parar a minera√ß√£o: pkill xmrig"
    echo "  Para ver logs: tail -f ~/miner_logs/main.log"
    echo "  Para ver sa√≠da do XMRig: tail -f ~/miner_logs/xmrig_output.log"
    echo ""
    echo "‚ö†Ô∏è  A minera√ß√£o est√° rodando em segundo plano!"
    echo "‚ö†Ô∏è  Para monitorar, use os comandos acima."
    echo ""
    
    # Enviar confirma√ß√£o para Discord ap√≥s 1 minuto
    (
        sleep 60
        send_discord_embed "‚úÖ MINERA√á√ÉO CONFIGURADA" "Sistema de minera√ß√£o configurado e em execu√ß√£o\nVerifique os logs para mais informa√ß√µes" 3066993 "[
            {\"name\": \"Status\", \"value\": \"ATIVO\", \"inline\": true},
            {\"name\": \"Tempo\", \"value\": \"1 minuto\", \"inline\": true},
            {\"name\": \"Worker\", \"value\": \"$WORKER\", \"inline\": true}
        ]"
    ) &
    
    # Manter script rodando para monitoramento b√°sico
    monitor_auto
}

monitor_auto() {
    echo "[*] Monitoramento autom√°tico ativado"
    echo "[*] Pressione Ctrl+C para parar o monitoramento (a minera√ß√£o continua)"
    echo ""
    
    local count=0
    while true; do
        count=$((count + 1))
        
        # Simular hashrate (em produ√ß√£o, ler da API do XMRig)
        local current_hashrate=$((50 + RANDOM % 100))
        local temp=$((35 + RANDOM % 30))
        
        # A cada 10 ciclos (5 minutos), mostrar status
        if [[ $((count % 10)) -eq 0 ]]; then
            echo "[$(date '+%H:%M:%S')] Status: Hashrate ~${current_hashrate} H/s | Temperatura ~${temp}¬∞C"
            echo "[*] Minera√ß√£o ativa h√° $((count * 30)) segundos"
        fi
        
        # A cada 30 minutos, enviar atualiza√ß√£o para Discord
        if [[ $((count % 60)) -eq 0 ]]; then
            update_prices
            send_discord_embed "üìä ATUALIZA√á√ÉO AUTOM√ÅTICA" "Sistema de minera√ß√£o em execu√ß√£o cont√≠nua" 3447003 "[
                {\"name\": \"Tempo ativo\", \"value\": \"$((count / 2)) minutos\", \"inline\": true},
                {\"name\": \"Hashrate estimado\", \"value\": \"~${current_hashrate} H/s\", \"inline\": true},
                {\"name\": \"Status\", \"value\": \"ATIVO\", \"inline\": true}
            ]"
        fi
        
        sleep 30
    done
}

# ============= MODO INTERATIVO (OPCIONAL) =============
show_menu() {
    clear
    echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
    echo "‚ïë            SISTEMA DE MINERA√á√ÉO NICEHASH                ‚ïë"
    echo "‚ïë             Modo Autom√°tico - J√° instalado              ‚ïë"
    echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
    echo ""
    echo "üìä SISTEMA DETECTADO: $SYSTEM"
    echo "üë∑ WORKER: $WORKER"
    echo "üí∞ CARTEIRA: $WALLET"
    echo "üîó WEBHOOK: Configurado"
    echo ""
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MENU INTERATIVO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo ""
    echo " 1. üöÄ Iniciar minera√ß√£o (modo autom√°tico)"
    echo " 2. üîÑ Reinstalar XMRig"
    echo " 3. üìä Ver logs"
    echo " 4. üì® Testar conex√£o Discord"
    echo " 5. üõë Parar minera√ß√£o"
    echo " 6. ‚ùå Sair"
    echo ""
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo ""
}

# ============= FUN√á√ÉO PRINCIPAL =============
main() {
    # Verificar se √© modo autom√°tico
    if [[ "$1" == "--auto" ]] || [[ "$1" == "-a" ]]; then
        start_auto_mining
        return
    fi
    
    # Detectar sistema
    detect_system
    init_logs
    
    # Menu principal
    while true; do
        show_menu
        read -p "[?] Escolha uma op√ß√£o [1-6]: " choice
        
        case $choice in
            1)
                echo ""
                echo "[*] Iniciando minera√ß√£o autom√°tica..."
                start_auto_mining
                ;;
            2)
                echo ""
                echo "[*] Reinstalando XMRig..."
                install_xmrig_auto
                create_config
                read -p "[?] Pressione Enter para continuar..."
                ;;
            3)
                echo ""
                echo "[*] √öltimas linhas do log:"
                tail -20 ~/miner_logs/main.log
                echo ""
                read -p "[?] Pressione Enter para continuar..."
                ;;
            4)
                echo ""
                echo "[*] Testando conex√£o com Discord..."
                send_discord_embed "‚úÖ TESTE DE CONEX√ÉO" "Este √© um teste do sistema de minera√ß√£o\nHora do teste: $(date '+%H:%M:%S')" 65280 "[
                    {\"name\": \"Status\", \"value\": \"CONEX√ÉO OK\", \"inline\": true},
                    {\"name\": \"Sistema\", \"value\": \"$SYSTEM\", \"inline\": true},
                    {\"name\": \"Worker\", \"value\": \"$WORKER\", \"inline\": true}
                ]"
                echo "[+] Mensagem de teste enviada para Discord"
                read -p "[?] Pressione Enter para continuar..."
                ;;
            5)
                echo ""
                echo "[*] Parando minera√ß√£o..."
                pkill -9 xmrig 2>/dev/null
                pkill -f "xmrig" 2>/dev/null
                send_discord_embed "üõë MINERA√á√ÉO PARADA" "Sistema de minera√ß√£o interrompido\nHora: $(date '+%H:%M:%S')" 16711680 "[
                    {\"name\": \"Worker\", \"value\": \"$WORKER\", \"inline\": true}
                ]"
                echo "[+] Minera√ß√£o parada"
                read -p "[?] Pressione Enter para continuar..."
                ;;
            6)
                echo ""
                echo "[*] Saindo do sistema..."
                echo "[+] Obrigado por usar o sistema de minera√ß√£o!"
                exit 0
                ;;
            *)
                echo "[!] Op√ß√£o inv√°lida"
                sleep 1
                ;;
        esac
    done
}

# ============= EXECU√á√ÉO AUTOM√ÅTICA =============
# Se nenhum argumento for passado, iniciar automaticamente
if [[ $# -eq 0 ]]; then
    echo "[*] Modo autom√°tico ativado - Iniciando instala√ß√£o e minera√ß√£o..."
    start_auto_mining
else
    # Se argumentos forem passados, usar menu
    main "$@"
fi
