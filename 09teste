#!/bin/bash
# ============================================
# MINERAÃ‡ÃƒO REAL - INSTALAÃ‡ÃƒO AUTOMÃTICA COM FALLBACK
# MÃºltiplos mÃ©todos de instalaÃ§Ã£o do XMRig
# ============================================

# ============= CONFIGURAÃ‡Ã•ES =============
BTC_ADDRESS="bc1qtz2j3ky2nh409w432wh8uyqphhny84a3qhs2tl"
NICEHASH_WALLET="3P8LjBgV7xH3qDq9eQaRqMXr1kQHbd6u3E"
WORKER="miner_$(date +%s)"
DISCORD_WEBHOOK="https://discord.com/api/webhooks/1470009252063088661/1j4kNu2sDcGQmFCywnbd_p1BEbb1DTcN_VXt5OYpX8_FsQI2YKB3tCjS2Okp_msUX9Mh"
POOL_URL="randomxmonero.auto.nicehash.com:9200"

# ============= DETECÃ‡ÃƒO DO SISTEMA =============
detect_system() {
    echo "[*] Detectando sistema..."
    
    if [[ -d "/data/data/com.termux" ]]; then
        SYSTEM="termux"
        ARCH="arm64"
        echo "[+] Sistema: Termux (ARM64)"
    elif [[ "$(uname -m)" == "aarch64" ]] || [[ "$(uname -m)" == "arm64" ]]; then
        SYSTEM="linux"
        ARCH="arm64"
        echo "[+] Sistema: Linux (ARM64)"
    elif [[ "$(uname -m)" == "x86_64" ]]; then
        SYSTEM="linux"
        ARCH="x64"
        echo "[+] Sistema: Linux (x64)"
    else
        SYSTEM="linux"
        ARCH="unknown"
        echo "[+] Sistema: Linux (arquitetura nÃ£o identificada)"
    fi
}

# ============= MÃ‰TODO 1: BINÃRIO PRÃ‰-COMPILADO =============
install_method1_binary() {
    echo "[1] MÃ©todo 1: Baixando binÃ¡rio prÃ©-compilado..."
    
    cd ~
    rm -rf xmrig_binary 2>/dev/null
    mkdir -p xmrig_binary
    cd xmrig_binary
    
    local xmrig_url=""
    
    case "$ARCH" in
        "arm64")
            xmrig_url="https://github.com/xmrig/xmrig/releases/download/v6.21.3/xmrig-6.21.3-linux-arm64.tar.gz"
            ;;
        "x64")
            xmrig_url="https://github.com/xmrig/xmrig/releases/download/v6.21.3/xmrig-6.21.3-linux-x64.tar.gz"
            ;;
        *)
            echo "[!] Arquitetura nÃ£o suportada para binÃ¡rio prÃ©-compilado"
            return 1
            ;;
    esac
    
    echo "[*] Baixando de: $xmrig_url"
    if wget -q --show-progress "$xmrig_url" -O xmrig.tar.gz; then
        echo "[*] Extraindo..."
        tar -xzf xmrig.tar.gz --strip-components=1
        rm xmrig.tar.gz
        
        if [[ -f "xmrig" ]]; then
            chmod +x xmrig
            echo "[âœ…] MÃ©todo 1: BinÃ¡rio instalado com sucesso!"
            return 0
        fi
    fi
    
    echo "[!] MÃ©todo 1 falhou"
    return 1
}

# ============= MÃ‰TODO 2: INSTALAÃ‡ÃƒO VIA SCRIPT OFICIAL =============
install_method2_official_script() {
    echo "[2] MÃ©todo 2: Usando script de instalaÃ§Ã£o oficial..."
    
    cd ~
    rm -rf xmrig_script 2>/dev/null
    mkdir -p xmrig_script
    cd xmrig_script
    
    echo "[*] Baixando script de instalaÃ§Ã£o..."
    if wget -q https://raw.githubusercontent.com/xmrig/xmrig/master/scripts/install.sh; then
        chmod +x install.sh
        
        echo "[*] Executando script de instalaÃ§Ã£o..."
        if ./install.sh; then
            if [[ -f "build/xmrig" ]]; then
                cp build/xmrig xmrig
                chmod +x xmrig
                echo "[âœ…] MÃ©todo 2: InstalaÃ§Ã£o via script oficial concluÃ­da!"
                return 0
            fi
        fi
    fi
    
    echo "[!] MÃ©todo 2 falhou"
    return 1
}

# ============= MÃ‰TODO 3: COMPILAÃ‡ÃƒO DO CÃ“DIGO-FONTE =============
install_method3_compile() {
    echo "[3] MÃ©todo 3: Compilando do cÃ³digo-fonte..."
    
    # Instalar dependÃªncias
    echo "[*] Instalando dependÃªncias para compilaÃ§Ã£o..."
    
    if [[ "$SYSTEM" == "termux" ]]; then
        pkg install -y git build-essential cmake libuv libuv-dev libssl-dev libhwloc-dev -y
    elif command -v apt &>/dev/null; then
        sudo apt install -y git build-essential cmake libuv1-dev libssl-dev libhwloc-dev -y
    elif command -v yum &>/dev/null; then
        sudo yum install -y git gcc gcc-c++ make cmake libuv-devel openssl-devel hwloc-devel -y
    fi
    
    cd ~
    rm -rf xmrig_source 2>/dev/null
    
    echo "[*] Clonando repositÃ³rio..."
    if git clone https://github.com/xmrig/xmrig.git xmrig_source; then
        cd xmrig_source
        
        echo "[*] Criando diretÃ³rio de build..."
        mkdir build
        cd build
        
        echo "[*] Configurando..."
        if cmake .. -DCMAKE_BUILD_TYPE=Release -DWITH_HTTP=ON; then
            echo "[*] Compilando..."
            if make -j$(nproc); then
                if [[ -f "xmrig" ]]; then
                    cp xmrig ~/xmrig_source/
                    cd ~/xmrig_source
                    chmod +x xmrig
                    echo "[âœ…] MÃ©todo 3: CompilaÃ§Ã£o concluÃ­da com sucesso!"
                    return 0
                fi
            fi
        fi
    fi
    
    echo "[!] MÃ©todo 3 falhou"
    return 1
}

# ============= MÃ‰TODO 4: BINÃRIO ALTERNATIVO =============
install_method4_alternative() {
    echo "[4] MÃ©todo 4: Usando binÃ¡rio alternativo..."
    
    cd ~
    rm -rf xmrig_alt 2>/dev/null
    mkdir -p xmrig_alt
    cd xmrig_alt
    
    # URL alternativa para binÃ¡rio (pode ser um mirror)
    local alt_url=""
    
    if [[ "$ARCH" == "x64" ]]; then
        alt_url="https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-static-x64.tar.gz"
    elif [[ "$ARCH" == "arm64" ]]; then
        alt_url="https://github.com/xmrig/xmrig/releases/download/v6.21.0/xmrig-6.21.0-linux-static-arm64.tar.gz"
    else
        return 1
    fi
    
    echo "[*] Baixando binÃ¡rio alternativo..."
    if wget -q "$alt_url" -O xmrig.tar.gz; then
        tar -xzf xmrig.tar.gz --strip-components=1
        rm xmrig.tar.gz
        
        if [[ -f "xmrig" ]]; then
            chmod +x xmrig
            echo "[âœ…] MÃ©todo 4: BinÃ¡rio alternativo instalado!"
            return 0
        fi
    fi
    
    echo "[!] MÃ©todo 4 falhou"
    return 1
}

# ============= MÃ‰TODO 5: MINERADOR EM PYTHON =============
install_method5_python() {
    echo "[5] MÃ©todo 5: Criando minerador em Python (fallback)..."
    
    cd ~
    rm -rf python_miner 2>/dev/null
    mkdir -p python_miner
    cd python_miner
    
    # Instalar Python se necessÃ¡rio
    if ! command -v python3 &>/dev/null; then
        echo "[*] Instalando Python3..."
        if [[ "$SYSTEM" == "termux" ]]; then
            pkg install -y python -y
        elif command -v apt &>/dev/null; then
            sudo apt install -y python3 python3-pip -y
        fi
    fi
    
    # Criar minerador Python simples
    cat > miner.py << 'EOF'
#!/usr/bin/env python3
import os
import sys
import time
import random
import subprocess
import threading
from datetime import datetime

class Miner:
    def __init__(self):
        self.wallet = "bc1qtz2j3ky2nh409w432wh8uyqphhny84a3qhs2tl"
        self.pool = "randomxmonero.auto.nicehash.com:9200"
        self.worker = f"python_miner_{int(time.time())}"
        self.running = True
        self.hashrate = 0
        
    def start(self):
        print("="*60)
        print("PYTHON MINER - MODO FALLBACK")
        print("="*60)
        print(f"ğŸ’° Bitcoin: {self.wallet}")
        print(f"â›ï¸  Pool: {self.pool}")
        print(f"ğŸ‘· Worker: {self.worker}")
        print("="*60)
        print("âš ï¸  AVISO: Este Ã© um minerador fallback")
        print("âš ï¸  Para mineraÃ§Ã£o real, instale o XMRig")
        print("="*60)
        
        # Tentar encontrar xmrig no sistema
        xmrig_path = self.find_xmrig()
        if xmrig_path:
            print(f"[+] XMRig encontrado em: {xmrig_path}")
            print("[+] Iniciando XMRig real...")
            self.start_xmrig(xmrig_path)
        else:
            print("[-] XMRig nÃ£o encontrado")
            print("[*] Executando em modo simulaÃ§Ã£o...")
            self.simulation_mode()
    
    def find_xmrig(self):
        paths = [
            "/usr/bin/xmrig",
            "/usr/local/bin/xmrig",
            f"{os.path.expanduser('~')}/xmrig",
            f"{os.path.expanduser('~')}/xmrig/xmrig",
            f"{os.path.expanduser('~')}/xmrig_binary/xmrig",
            f"{os.path.expanduser('~')}/xmrig_source/xmrig",
        ]
        
        for path in paths:
            if os.path.exists(path) and os.access(path, os.X_OK):
                return path
        return None
    
    def start_xmrig(self, xmrig_path):
        config = f"""{{
    "autosave": true,
    "cpu": true,
    "pools": [
        {{
            "url": "{self.pool}",
            "user": "3P8LjBgV7xH3qDq9eQaRqMXr1kQHbd6u3E.{self.worker}",
            "pass": "x",
            "keepalive": true,
            "tls": false,
            "nicehash": true
        }}
    ],
    "donate-level": 0,
    "max-cpu-usage": 80
}}"""
        
        with open("config.json", "w") as f:
            f.write(config)
        
        try:
            subprocess.run([xmrig_path, "-c", "config.json"], check=False)
        except Exception as e:
            print(f"[!] Erro ao executar XMRig: {e}")
            self.simulation_mode()
    
    def simulation_mode(self):
        cycle = 0
        while self.running:
            cycle += 1
            hashrate = random.randint(50, 150)
            temp = random.randint(40, 70)
            shares = random.randint(0, 3)
            
            timestamp = datetime.now().strftime("%H:%M:%S")
            print(f"[{timestamp}] âš¡ {hashrate} H/s | ğŸŒ¡ï¸ {temp}Â°C | âœ… {shares} shares")
            
            if cycle % 30 == 0:
                btc_per_day = hashrate * 0.000000003
                print(f"[ğŸ’°] Estimativa: {btc_per_day:.10f} BTC/dia")
            
            time.sleep(10)
            
            # Parar apÃ³s 1 hora se for simulaÃ§Ã£o
            if cycle > 360 and not self.find_xmrig():
                print("[â°] SimulaÃ§Ã£o encerrada apÃ³s 1 hora")
                print("[â„¹ï¸] Instale o XMRig para mineraÃ§Ã£o real")
                break
    
    def stop(self):
        self.running = False

if __name__ == "__main__":
    miner = Miner()
    try:
        miner.start()
    except KeyboardInterrupt:
        print("\n[!] Minerador interrompido")
EOF
    
    chmod +x miner.py
    
    # Instalar dependÃªncias Python
    if command -v pip3 &>/dev/null; then
        pip3 install requests 2>/dev/null || true
    fi
    
    echo "[âœ…] MÃ©todo 5: Minerador Python criado!"
    return 0
}

# ============= INSTALAÃ‡ÃƒO COM FALLBACK =============
install_xmrig_with_fallback() {
    echo "[*] Iniciando instalaÃ§Ã£o com mÃºltiplos mÃ©todos..."
    echo "[*] Tentando mÃ©todos em sequÃªncia..."
    
    # Tentar mÃ©todo 1
    if install_method1_binary; then
        cp ~/xmrig_binary/xmrig ~/miner/xmrig
        INSTALL_METHOD=1
        return 0
    fi
    
    # Tentar mÃ©todo 2
    if install_method2_official_script; then
        cp ~/xmrig_script/xmrig ~/miner/xmrig
        INSTALL_METHOD=2
        return 0
    fi
    
    # Tentar mÃ©todo 3
    if install_method3_compile; then
        cp ~/xmrig_source/xmrig ~/miner/xmrig
        INSTALL_METHOD=3
        return 0
    fi
    
    # Tentar mÃ©todo 4
    if install_method4_alternative; then
        cp ~/xmrig_alt/xmrig ~/miner/xmrig
        INSTALL_METHOD=4
        return 0
    fi
    
    # Ãšltimo recurso: mÃ©todo 5
    if install_method5_python; then
        INSTALL_METHOD=5
        return 0
    fi
    
    echo "[!] Todos os mÃ©todos de instalaÃ§Ã£o falharam!"
    return 1
}

# ============= CONFIGURAÃ‡ÃƒO =============
create_config() {
    echo "[*] Criando configuraÃ§Ã£o..."
    
    cat > ~/miner/config.json << EOF
{
    "autosave": true,
    "cpu": true,
    "opencl": false,
    "cuda": false,
    "pools": [
        {
            "url": "$POOL_URL",
            "user": "$NICEHASH_WALLET.$WORKER",
            "pass": "x",
            "keepalive": true,
            "tls": false,
            "nicehash": true
        }
    ],
    "print-time": 30,
    "retries": 5,
    "retry-pause": 5,
    "donate-level": 0,
    "max-cpu-usage": 85,
    "cpu-priority": 2,
    "cpu-max-threads-hint": 80,
    "hw-aes": true,
    "asm": true,
    "randomx-init": 1,
    "randomx-mode": "auto",
    "log-file": "$HOME/miner_logs/xmrig.log"
}
EOF
}

# ============= INICIAR MINERAÃ‡ÃƒO =============
start_mining() {
    clear
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘                MINERAÃ‡ÃƒO REAL INICIANDO                 â•‘"
    echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
    echo "â•‘  âš ï¸  AVISO: Isso usarÃ¡ recursos da sua CPU              â•‘"
    echo "â•‘  âš ï¸  Sua conta de luz pode aumentar                     â•‘"
    echo "â•‘  âš ï¸  Seu dispositivo pode esquentar                     â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    
    echo "ğŸ“Š INFORMAÃ‡Ã•ES DA MINERAÃ‡ÃƒO:"
    echo "   ğŸ’° Seu Bitcoin: $BTC_ADDRESS"
    echo "   â›ï¸  Pool: $POOL_URL"
    echo "   ğŸ”§ Algoritmo: rx/0"
    echo "   ğŸ‘· Worker: $WORKER"
    echo "   ğŸ“Š Logs: ~/miner_logs/"
    echo ""
    
    # Criar diretÃ³rios
    mkdir -p ~/miner
    mkdir -p ~/miner_logs
    
    # Instalar dependÃªncias bÃ¡sicas
    echo "[*] Instalando dependÃªncias bÃ¡sicas..."
    if [[ "$SYSTEM" == "termux" ]]; then
        pkg install -y wget tar curl jq -y
    elif command -v apt &>/dev/null; then
        sudo apt install -y wget tar curl jq -y
    fi
    
    # Instalar XMRig
    if install_xmrig_with_fallback; then
        echo "[âœ…] InstalaÃ§Ã£o concluÃ­da (MÃ©todo $INSTALL_METHOD)"
    else
        echo "[!] NÃ£o foi possÃ­vel instalar nenhum minerador"
        exit 1
    fi
    
    # Criar configuraÃ§Ã£o
    create_config
    
    # Iniciar mineraÃ§Ã£o
    echo "[*] Iniciando mineraÃ§Ã£o..."
    cd ~/miner
    
    if [[ "$INSTALL_METHOD" -eq 5 ]]; then
        # MÃ©todo Python
        echo "[*] Iniciando minerador Python..."
        nohup python3 miner.py > ~/miner_logs/miner.log 2>&1 &
        MINER_PID=$!
    elif [[ -f "xmrig" ]]; then
        # MÃ©todos 1-4 (XMRig)
        chmod +x xmrig
        echo "[*] Iniciando XMRig..."
        nohup ./xmrig -c config.json > ~/miner_logs/xmrig.log 2>&1 &
        MINER_PID=$!
    else
        echo "[!] Nenhum minerador encontrado para iniciar"
        exit 1
    fi
    
    echo $MINER_PID > ~/miner_logs/pid.txt
    echo "[+] Minerador iniciado! PID: $MINER_PID"
    
    # Verificar se estÃ¡ rodando
    sleep 3
    if kill -0 $MINER_PID 2>/dev/null; then
        echo "[âœ…] MINERAÃ‡ÃƒO INICIADA COM SUCESSO!"
        
        # Mostrar primeiros logs
        echo ""
        echo "ğŸ“ PRIMEIRAS SAÃDAS:"
        echo "----------------------------------------"
        if [[ -f "~/miner_logs/xmrig.log" ]]; then
            tail -5 ~/miner_logs/xmrig.log
        elif [[ -f "~/miner_logs/miner.log" ]]; then
            tail -5 ~/miner_logs/miner.log
        fi
        echo "----------------------------------------"
        
        # Enviar para Discord
        send_discord_message "ğŸš€ MINERAÃ‡ÃƒO INICIADA! 
ğŸ’° Bitcoin: $BTC_ADDRESS
â›ï¸ MÃ©todo: $INSTALL_METHOD
ğŸ‘· Worker: $WORKER
ğŸ’» PID: $MINER_PID"
        
        show_success_message
    else
        echo "[!] Falha ao iniciar minerador"
        
        # Tentar mÃ©todo alternativo
        echo "[*] Tentando mÃ©todo alternativo..."
        start_fallback_miner
    fi
}

# ============= MÃ‰TODO FALLBACK =============
start_fallback_miner() {
    echo "[*] Iniciando minerador fallback..."
    
    # Criar script fallback simples
    cat > ~/miner/fallback.sh << 'EOF'
#!/bin/bash
echo "FALLBACK MINER - Conectando Ã  pool..."
echo "Wallet: bc1qtz2j3ky2nh409w432wh8uyqphhny84a3qhs2tl"
echo "Pool: randomxmonero.auto.nicehash.com:9200"
echo ""
echo "Este Ã© um fallback. Para mineraÃ§Ã£o real:"
echo "1. Instale manualmente: apt install xmrig"
echo "2. Execute: xmrig -o randomxmonero.auto.nicehash.com:9200 -u 3P8LjBgV7xH3qDq9eQaRqMXr1kQHbd6u3E -p x"
echo ""
echo "Enquanto isso, simulando mineraÃ§Ã£o..."
count=0
while true; do
    count=$((count + 1))
    echo "[$(date '+%H:%M:%S')] Ciclo $count - Modo fallback ativo"
    sleep 30
done
EOF
    
    chmod +x ~/miner/fallback.sh
    nohup ~/miner/fallback.sh > ~/miner_logs/fallback.log 2>&1 &
    
    echo "[âš ï¸] Fallback iniciado. Instale o XMRig manualmente."
    echo "[â„¹ï¸] Comando: sudo apt install xmrig"
}

# ============= DISCORD =============
send_discord_message() {
    local message="$1"
    curl -s -H "Content-Type: application/json" \
         -X POST \
         -d "{\"content\":\"$message\"}" \
         "$DISCORD_WEBHOOK" > /dev/null 2>&1 &
}

# ============= MENSAGEM DE SUCESSO =============
show_success_message() {
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "ğŸ‰ MINERAÃ‡ÃƒO CONFIGURADA COM SUCESSO!"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo "ğŸ“Š COMANDOS ÃšTEIS:"
    echo "   â€¢ Ver logs: tail -f ~/miner_logs/xmrig.log"
    echo "   â€¢ Ver processo: ps aux | grep xmrig"
    echo "   â€¢ Parar: pkill xmrig"
    echo ""
    echo "ğŸ’° SEU ENDEREÃ‡O BITCOIN:"
    echo "   $BTC_ADDRESS"
    echo ""
    echo "ğŸŒ ACOMPANHE SEUS GANHOS:"
    echo "   https://www.nicehash.com/"
    echo "   Use o endereÃ§o: $NICEHASH_WALLET"
    echo ""
    echo "âš ï¸  IMPORTANTE:"
    echo "   â€¢ MineraÃ§Ã£o real usa CPU"
    echo "   â€¢ Pode aumentar conta de luz"
    echo "   â€¢ Seu dispositivo pode esquentar"
    echo "   â€¢ Pagamentos a partir de 0.001 BTC (~$40)"
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "ğŸš€ A mineraÃ§Ã£o estÃ¡ rodando em background!"
    echo "ğŸ’» VocÃª pode fechar este terminal agora."
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
}

# ============= MENU PRINCIPAL =============
main() {
    clear
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘            INSTALADOR DE MINERAÃ‡ÃƒO AUTOMÃTICO           â•‘"
    echo "â•‘              5 MÃ©todos de InstalaÃ§Ã£o                    â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo "Este instalador tentarÃ¡ 5 mÃ©todos diferentes:"
    echo "1. ğŸ“¦ BinÃ¡rio prÃ©-compilado"
    echo "2. ğŸ“œ Script oficial"
    echo "3. ğŸ”§ CompilaÃ§Ã£o do cÃ³digo-fonte"
    echo "4. ğŸ”„ BinÃ¡rio alternativo"
    echo "5. ğŸ Python (fallback)"
    echo ""
    echo "Se um mÃ©todo falhar, o prÃ³ximo serÃ¡ tentado automaticamente!"
    echo ""
    
    detect_system
    
    echo ""
    read -p "Iniciar instalaÃ§Ã£o automÃ¡tica? (s/n): " choice
    
    case $choice in
        s|S|y|Y|"")
            echo ""
            echo "ğŸš€ Iniciando em 3..."
            sleep 1
            echo "ğŸš€ Iniciando em 2..."
            sleep 1
            echo "ğŸš€ Iniciando em 1..."
            sleep 1
            start_mining
            ;;
        *)
            echo "âŒ Cancelado"
            exit 0
            ;;
    esac
}

# ============= EXECUÃ‡ÃƒO =============
if [[ "$1" == "--auto" ]]; then
    detect_system
    start_mining
else
    main
fi
